<div class="network-config-page">
  
  <!-- Header de la página -->
  <div class="config-header">
    <div class="header-content">
      <span class="header-tag font-mono">SETUP WIZARD</span>
      <h1 class="header-title font-display">Configuración del Sistema</h1>
      <p class="header-subtitle">
        Configure SENTINEL-ML para monitorear su infraestructura de red. 
        Siga los pasos para una integración completa.
      </p>
    </div>
    
    <!-- Indicador de progreso general -->
    <div class="progress-indicator">
      <div class="progress-circle">
        <svg viewBox="0 0 100 100">
          <circle class="progress-bg" cx="50" cy="50" r="45" />
          <circle 
            class="progress-fill" 
            cx="50" cy="50" r="45"
            [style.stroke-dashoffset]="283 - (283 * progressPercentage() / 100)" />
        </svg>
        <span class="progress-value font-display">{{ progressPercentage() }}%</span>
      </div>
      <span class="progress-label font-mono">COMPLETADO</span>
    </div>
  </div>
  
  <!-- Stepper visual -->
  <div class="config-stepper">
    @for (step of steps; track step.id; let i = $index; let last = $last) {
      <div 
        class="step-item" 
        [class]="getStepClass(step)"
        (click)="goToStep(step.id)">
        <div class="step-indicator">
          @if (step.completado) {
            <mat-icon>check</mat-icon>
          } @else {
            <mat-icon>{{ step.icon }}</mat-icon>
          }
        </div>
        <div class="step-content">
          <span class="step-title">{{ step.titulo }}</span>
          <span class="step-description font-mono">{{ step.descripcion }}</span>
        </div>
      </div>
      @if (!last) {
        <div class="step-connector" [class.completed]="step.completado"></div>
      }
    }
  </div>
  
  <!-- Contenido del paso actual -->
  <div class="config-content" [@stepTransition]="currentStep()">
    
    @switch (currentStep()) {
      <!-- Paso 1: Tipo de Red -->
      @case (1) {
        <app-network-type-selector-page
          (networkSelected)="onNetworkSelected($event)">
        </app-network-type-selector-page>
      }
      
      <!-- Paso 2: Dispositivos -->
      @case (2) {
        <div class="step-placeholder" @fadeSlide>
          <div class="placeholder-icon">
            <mat-icon>devices</mat-icon>
          </div>
          <h2>Detección de Dispositivos</h2>
          <p>
            Red seleccionada: <strong style="color: var(--primary)">{{ selectedNetwork()?.nombre }}</strong>
          </p>
          <p class="text-muted">
            SENTINEL-ML escaneará la red para detectar todos los dispositivos conectados.
          </p>
          
          <!-- Preview de la red seleccionada -->
          @if (selectedNetwork(); as network) {
            <div class="network-preview card">
              <div class="preview-header">
                <mat-icon [style.color]="network.color">{{ network.icon }}</mat-icon>
                <span>{{ network.nombre }}</span>
              </div>
              <div class="preview-stats">
                <div class="preview-stat">
                  <span class="stat-value font-display">{{ network.dispositivos }}+</span>
                  <span class="stat-label font-mono">DISPOSITIVOS</span>
                </div>
                <div class="preview-stat">
                  <span class="stat-value font-display">{{ network.velocidad }}</span>
                  <span class="stat-label font-mono">VELOCIDAD</span>
                </div>
                <div class="preview-stat">
                  <span class="stat-value font-display">{{ network.cobertura }}</span>
                  <span class="stat-label font-mono">COBERTURA</span>
                </div>
              </div>
            </div>
          }
          
          <div class="placeholder-actions">
            <button class="btn-sentinel btn-sentinel-secondary" (click)="previousStep()">
              <mat-icon>arrow_back</mat-icon>
              Anterior
            </button>
            <button class="btn-sentinel btn-sentinel-primary" (click)="nextStep()">
              Escanear Dispositivos
              <mat-icon>search</mat-icon>
            </button>
          </div>
        </div>
      }
      
      <!-- Paso 3: Seguridad -->
      @case (3) {
        <div class="step-placeholder" @fadeSlide>
          <div class="placeholder-icon warning">
            <mat-icon>security</mat-icon>
          </div>
          <h2>Configuración de Seguridad</h2>
          <p class="text-muted">
            Configure las políticas de seguridad y umbrales de detección para su red.
          </p>
          
          <div class="security-options">
            <div class="security-card card">
              <mat-icon>shield</mat-icon>
              <h4>Detección de Intrusiones</h4>
              <p>IDS/IPS activo</p>
            </div>
            <div class="security-card card">
              <mat-icon>psychology</mat-icon>
              <h4>Machine Learning</h4>
              <p>Detección de anomalías</p>
            </div>
            <div class="security-card card">
              <mat-icon>visibility</mat-icon>
              <h4>Monitoreo 24/7</h4>
              <p>Alertas en tiempo real</p>
            </div>
          </div>
          
          <div class="placeholder-actions">
            <button class="btn-sentinel btn-sentinel-secondary" (click)="previousStep()">
              <mat-icon>arrow_back</mat-icon>
              Anterior
            </button>
            <button class="btn-sentinel btn-sentinel-primary" (click)="nextStep()">
              Configurar Políticas
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>
        </div>
      }
      
      <!-- Paso 4: Activación -->
      @case (4) {
        <div class="step-placeholder final" @fadeSlide>
          @if (!configCompleted()) {
            <div class="placeholder-icon success">
              <mat-icon>radar</mat-icon>
            </div>
            <h2>Activar SENTINEL-ML</h2>
            <p class="text-muted">
              Todo está listo. Active el sistema de monitoreo para comenzar a proteger su red.
            </p>
            
            <div class="activation-summary card">
              <h4 class="font-mono">RESUMEN DE CONFIGURACIÓN</h4>
              <div class="summary-grid">
                <div class="summary-item">
                  <span class="label">Tipo de Red</span>
                  <span class="value" [style.color]="selectedNetwork()?.color">
                    {{ selectedNetwork()?.nombre }}
                  </span>
                </div>
                <div class="summary-item">
                  <span class="label">Dispositivos</span>
                  <span class="value">{{ selectedNetwork()?.dispositivos }}+ detectados</span>
                </div>
                <div class="summary-item">
                  <span class="label">Nivel de Riesgo</span>
                  <span class="value badge-status" [class]="selectedNetwork()?.riesgo === 'alto' ? 'critical' : selectedNetwork()?.riesgo === 'medio' ? 'medium' : 'success'">
                    {{ selectedNetwork()?.riesgo | uppercase }}
                  </span>
                </div>
                <div class="summary-item">
                  <span class="label">Protocolos</span>
                  <span class="value">{{ selectedNetwork()?.protocolos?.length }} configurados</span>
                </div>
              </div>
            </div>
            
            <div class="placeholder-actions">
              <button class="btn-sentinel btn-sentinel-secondary" (click)="previousStep()">
                <mat-icon>arrow_back</mat-icon>
                Anterior
              </button>
              <button 
                class="btn-sentinel btn-sentinel-primary activate-btn" 
                (click)="finishConfiguration()">
                <mat-icon>power_settings_new</mat-icon>
                Activar Sistema
              </button>
            </div>
          } @else {
            <!-- Estado de activación completada -->
            <div class="activation-success">
              <div class="success-animation">
                <div class="success-circle">
                  <mat-icon>check</mat-icon>
                </div>
                <div class="success-rings">
                  <div class="ring ring-1"></div>
                  <div class="ring ring-2"></div>
                  <div class="ring ring-3"></div>
                </div>
              </div>
              <h2 class="font-display">¡Sistema Activado!</h2>
              <p>SENTINEL-ML está protegiendo su red</p>
              <p class="font-mono redirect-text">Redirigiendo al dashboard...</p>
            </div>
          }
        </div>
      }
    }
  </div>
</div>